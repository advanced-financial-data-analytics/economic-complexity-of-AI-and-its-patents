<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.52">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Barry Quinn">

<title>Beyond Algorithms</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="beyond_algos_files/libs/clipboard/clipboard.min.js"></script>
<script src="beyond_algos_files/libs/quarto-html/quarto.js"></script>
<script src="beyond_algos_files/libs/quarto-html/popper.min.js"></script>
<script src="beyond_algos_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="beyond_algos_files/libs/quarto-html/anchor.min.js"></script>
<link href="beyond_algos_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="beyond_algos_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="beyond_algos_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="beyond_algos_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="beyond_algos_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Beyond Algorithms</h1>
<p class="subtitle lead">Complex economics of AI and its patents</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Barry Quinn </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="an-interdisciplinary-definition-of-ai" class="level2">
<h2 class="anchored" data-anchor-id="an-interdisciplinary-definition-of-ai">An interdisciplinary definition of AI</h2>
<p>Artificial Intelligence (AI) in an economic context can be defined as:</p>
<blockquote class="blockquote">
<p>A novel form of adaptive capital<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, characterised by goal-oriented computational systems capable of making intelligent decisions to achieve specified objectives <span class="citation" data-cites="Russell2020">(<a href="#ref-Russell2020" role="doc-biblioref">Russell and Norvig 2020</a>)</span>.</p>
</blockquote>
<p>This technology functions as both a complement to and substitute for human labour in the production of goods and services, potentially augmenting productivity whilst simultaneously altering the relative demand for various types of human skills and labour <span class="citation" data-cites="Acemoglu2018 Brynjolfsson2017a">(<a href="#ref-Acemoglu2018" role="doc-biblioref">Acemoglu and Restrepo 2018</a>; <a href="#ref-Brynjolfsson2017a" role="doc-biblioref">Brynjolfsson and Mitchell 2017</a>)</span>.</p>
<p>Unlike traditional capital, AI demonstrates the capacity for open-ended intelligence, adapting to diverse problems and potentially yielding increasing returns to scale in economic processes <span class="citation" data-cites="Agrawal2018">(<a href="#ref-Agrawal2018" role="doc-biblioref">Agrawal, Gans, and Goldfarb 2018</a>)</span>. The economic impact of AI is intrinsically linked to the alignment of its objectives with human values and economic goals, a concept known as ‘value alignment’ <span class="citation" data-cites="Russell2019">(<a href="#ref-Russell2019" role="doc-biblioref">Russell 2019</a>)</span>. This alignment (or misalignment) could significantly influence labour markets, productivity, and wealth distribution <span class="citation" data-cites="Korinek2017">(<a href="#ref-Korinek2017" role="doc-biblioref">Korinek and Stiglitz 2017</a>)</span>.</p>
<p>AI’s ability to manage uncertainty and improve performance through machine learning introduces a dynamic element to its role as capital, potentially leading to evolving economic effects over time <span class="citation" data-cites="Jordan2015">(<a href="#ref-Jordan2015" role="doc-biblioref">Jordan and Mitchell 2015</a>)</span>. The development of AI, particularly towards more general capabilities, may have profound long-term economic implications, including structural changes in labour markets, shifts in comparative advantages between nations, and potential alterations to economic growth models <span class="citation" data-cites="Trajtenberg2018">(<a href="#ref-Trajtenberg2018" role="doc-biblioref">Trajtenberg 2018</a>)</span>.</p>
<p>From an economic perspective, the concept of ‘provably beneficial AI’ <span class="citation" data-cites="Russell2020">(<a href="#ref-Russell2020" role="doc-biblioref">Russell and Norvig 2020</a>)</span> suggests a need for economic mechanisms and incentives that ensure AI development aligns with broader societal and economic welfare. Understanding the economics of AI necessitates an interdisciplinary approach, integrating insights from computer science, economics, ethics, and other relevant fields to comprehend its full impact on economic systems and human welfare <span class="citation" data-cites="Brynjolfsson2017">(<a href="#ref-Brynjolfsson2017" role="doc-biblioref">Brynjolfsson and McAfee 2017</a>)</span>.</p>
<p>This definition provides a framework for analysing the economic implications of AI, considering both its current applications and potential future developments. It emphasises the need for careful consideration of AI’s unique properties as a form of capital and the importance of aligning its development with human values and economic objectives.</p>
</section>
<section id="intellectual-property-and-ai-patents" class="level2">
<h2 class="anchored" data-anchor-id="intellectual-property-and-ai-patents">Intellectual Property and AI Patents</h2>
<p>In the realm of intellectual property, the quality of AI patents has emerged as a critical area of study with significant economic implications. AI patent quality refers to the technical merit, novelty, and potential economic value of patented AI innovations. Research indicates that the rapid growth in AI patent filings has led to concerns about patent quality, with potential ramifications for innovation dynamics and market structure in AI-intensive industries <span class="citation" data-cites="Fujii2018">(<a href="#ref-Fujii2018" role="doc-biblioref">Fujii and Managi 2018</a>)</span>.</p>
<p>From a legal perspective, AI patents face unique challenges due to the abstract nature of AI algorithms and the difficulty in clearly delineating the boundaries of AI inventions <span class="citation" data-cites="epo2017">(<a href="#ref-epo2017" role="doc-biblioref"><strong>epo2017?</strong></a>)</span>. This complexity can lead to increased uncertainty in patent enforcement and potentially higher transaction costs in technology markets <span class="citation" data-cites="Lerner2015">(<a href="#ref-Lerner2015" role="doc-biblioref">Lerner and Tirole 2015</a>)</span>. Moreover, the quality of AI patents has implications for market concentration and competition. High-quality patents may create significant entry barriers, potentially leading to market dominance by a few firms with strong AI patent portfolios <span class="citation" data-cites="Cockburn2019">(<a href="#ref-Cockburn2019" role="doc-biblioref">Cockburn, Henderson, and Stern 2019</a>)</span>.</p>
<p>Economic research suggests that the quality of AI patents can significantly influence the direction and pace of AI innovation. High-quality patents that effectively protect genuine inventions can stimulate further research and development, while low-quality patents might impede innovation by creating ‘patent thickets’ that are costly to navigate <span class="citation" data-cites="Hall2017">(<a href="#ref-Hall2017" role="doc-biblioref">Hall et al. 2017</a>)</span>. Furthermore, the international dimension of AI patent quality has implications for global technology transfer and economic competitiveness. Differences in patent examination standards across jurisdictions can lead to variations in AI patent quality, potentially affecting international technology diffusion and trade in AI-intensive goods and services <span class="citation" data-cites="Fink2016">(<a href="#ref-Fink2016" role="doc-biblioref">Fink, Khan, and Zhou 2016</a>)</span>.</p>
<p>From a policy perspective, maintaining high AI patent quality is crucial for fostering innovation while preventing anticompetitive behaviour. This necessitates a delicate balance between protecting inventors’ rights and ensuring sufficient knowledge spillovers to drive cumulative innovation in the AI field <span class="citation" data-cites="Furman2019">(<a href="#ref-Furman2019" role="doc-biblioref">Furman and Seamans 2019</a>)</span>. The multidisciplinary nature of AI further complicates this balance, as it requires patent examiners and policymakers to possess expertise across multiple domains, including computer science, mathematics, and specific application areas of AI <span class="citation" data-cites="Dwivedi2021">(<a href="#ref-Dwivedi2021" role="doc-biblioref">Dwivedi et al. 2021</a>)</span>.</p>
<p>These considerations surrounding AI patent quality add another layer of complexity to the economics of AI, highlighting the intricate relationships between intellectual property regimes, innovation dynamics, market structures, and economic outcomes in AI-driven industries.</p>
</section>
<section id="conclusion-and-future-directions" class="level2">
<h2 class="anchored" data-anchor-id="conclusion-and-future-directions">Conclusion and future directions</h2>
<p>The economics of AI represents a complex and rapidly evolving field that necessitates an interdisciplinary approach. As we have seen, AI’s role as a novel form of adaptive capital has far-reaching implications for labour markets, productivity, and wealth distribution. The intricate interplay between AI development and patent quality further complicates this landscape, introducing challenges and opportunities in innovation dynamics, market structures, and global competitiveness. The concept of ‘value alignment’ emerges as a critical factor, bridging technological capabilities with economic and societal objectives. As AI continues to advance, maintaining a balance between fostering innovation and ensuring equitable outcomes will require ongoing collaboration between economists, computer scientists, legal experts, and policymakers. Future research should focus on empirical studies of AI’s economic impact, refinement of AI patent quality metrics, and development of policy frameworks that promote ‘provably beneficial AI’. Additionally, exploring the implications of AI on international economic relations and investigating potential new economic models suited to an AI-driven world will be crucial. By embracing this multidisciplinary perspective, we can work towards harnessing the full potential of AI while mitigating its risks, ultimately shaping an economic future that aligns technological progress with human values and societal well-being.</p>
</section>
<section id="references" class="level2 unnumbered">


</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Acemoglu2018" class="csl-entry" role="listitem">
Acemoglu, Daron, and Pascual Restrepo. 2018. <span>“The Race Between Man and Machine: Implications of Technology for Growth, Factor Shares, and Employment.”</span> <em>American Economic Review</em> 108 (6): 1488–1542. <a href="https://www.nber.org/system/files/working_papers/w22252/w22252.pdf">https://www.nber.org/system/files/working_papers/w22252/w22252.pdf</a>.
</div>
<div id="ref-Agrawal2018" class="csl-entry" role="listitem">
Agrawal, Ajay, Joshua Gans, and Avi Goldfarb. 2018. <em>Prediction Machines: The Simple Economics of Artificial Intelligence</em>. Harvard Business Review Press. <a href="https://books.google.com/books/about/Prediction_Machines.html?id=wJY4DwAAQBAJ">https://books.google.com/books/about/Prediction_Machines.html?id=wJY4DwAAQBAJ</a>.
</div>
<div id="ref-Brynjolfsson2017" class="csl-entry" role="listitem">
Brynjolfsson, Erik, and Andrew McAfee. 2017. <em>Machine, Platform, Crowd: Harnessing Our Digital Future</em>. W. W. Norton &amp; Company. <a href="https://www.amazon.co.uk/Machine-Platform-Crowd-Harnessing-Revolution/dp/0393254291">https://www.amazon.co.uk/Machine-Platform-Crowd-Harnessing-Revolution/dp/0393254291</a>.
</div>
<div id="ref-Brynjolfsson2017a" class="csl-entry" role="listitem">
Brynjolfsson, Erik, and Tom Mitchell. 2017. <span>“What Can Machine Learning Do? Workforce Implications.”</span> <em>Science</em> 358 (6370): 1530–34. <a href="http://dx.doi.org/10.1126/science.aap8062">http://dx.doi.org/10.1126/science.aap8062</a>.
</div>
<div id="ref-Cockburn2019" class="csl-entry" role="listitem">
Cockburn, Iain M., Rebecca Henderson, and Scott Stern. 2019. <span>“The Impact of Artificial Intelligence on Innovation: An Exploratory Analysis.”</span> In <em>The Economics of Artificial Intelligence: An Agenda</em>, edited by Ajay Agrawal, Joshua Gans, and Avi Goldfarb, 115–46. University of Chicago Press. <a href="https://www.nber.org/books-and-chapters/economics-artificial-intelligence-agenda/impact-artificial-intelligence-innovation-exploratory-analysis">https://www.nber.org/books-and-chapters/economics-artificial-intelligence-agenda/impact-artificial-intelligence-innovation-exploratory-analysis</a>.
</div>
<div id="ref-Dwivedi2021" class="csl-entry" role="listitem">
Dwivedi, Yogesh K., Laurie Hughes, Elvira Ismagilova, Gert Aarts, Crispin Coombs, Tom Crick, Yanqing Duan, et al. 2021. <span>“Artificial Intelligence (AI): Multidisciplinary Perspectives on Emerging Challenges, Opportunities, and Agenda for Research, Practice and Policy.”</span> <em>International Journal of Information Management</em> 57: 101994. https://doi.org/<a href="https://doi.org/10.1016/j.ijinfomgt.2019.08.002">https://doi.org/10.1016/j.ijinfomgt.2019.08.002</a>.
</div>
<div id="ref-Fink2016" class="csl-entry" role="listitem">
Fink, Carsten, Mosahid Khan, and Hao Zhou. 2016. <span>“Exploring the Worldwide Patent Surge.”</span> <em>Economics of Innovation and New Technology</em> 25 (2): 114–42. <a href="https://www.tandfonline.com/doi/full/10.1080/10438599.2015.1055088">https://www.tandfonline.com/doi/full/10.1080/10438599.2015.1055088</a>.
</div>
<div id="ref-Fujii2018" class="csl-entry" role="listitem">
Fujii, Hidemichi, and Shunsuke Managi. 2018. <span>“Trends and Priority Shifts in Artificial Intelligence Technology Invention: A Global Patent Analysis.”</span> <em>Economic Analysis and Policy</em> 58: 60–69. <a href="https://doi.org/10.1016/j.eap.2017.12.006">https://doi.org/10.1016/j.eap.2017.12.006</a>.
</div>
<div id="ref-Furman2019" class="csl-entry" role="listitem">
Furman, Jason L., and Robert Seamans. 2019. <span>“AI and the Economy.”</span> <em>Innovation Policy and the Economy</em> 19: 161–91. <a href="https://www.journals.uchicago.edu/doi/full/10.1086/699936">https://www.journals.uchicago.edu/doi/full/10.1086/699936</a>.
</div>
<div id="ref-Hall2017" class="csl-entry" role="listitem">
Hall, Bronwyn H., Christian Helmers, Georg von Graevenitz, and Chiara Rosazza-Bondibene. 2017. <span>“Technology Entry in the Presence of Patent Thickets.”</span> Working Paper 21455. NBER. <a href="https://www.nber.org/papers/w21455">https://www.nber.org/papers/w21455</a>.
</div>
<div id="ref-Jordan2015" class="csl-entry" role="listitem">
Jordan, Michael I., and Tom M. Mitchell. 2015. <span>“Machine Learning: Trends, Perspectives, and Prospects.”</span> <em>Science</em> 349 (6245): 255–60.<a href=" https://doi.org/aaa8415"> https://doi.org/aaa8415</a>.
</div>
<div id="ref-Korinek2017" class="csl-entry" role="listitem">
Korinek, Anton, and Joseph E. Stiglitz. 2017. <span>“Artificial Intelligence and Its Implications for Income Distribution and Unemployment.”</span> 24174. NBER. <a href="https://www.nber.org/system/files/working_papers/w24174/w24174.pdf">https://www.nber.org/system/files/working_papers/w24174/w24174.pdf</a>.
</div>
<div id="ref-Lerner2015" class="csl-entry" role="listitem">
Lerner, Josh, and Jean Tirole. 2015. <span>“Standard-Essential Patents.”</span> <em>Journal of Political Economy</em> 123 (3): 547–86. <a href="https://www.journals.uchicago.edu/doi/10.1086/680995">https://www.journals.uchicago.edu/doi/10.1086/680995</a>.
</div>
<div id="ref-Russell2019" class="csl-entry" role="listitem">
Russell, Stuart. 2019. <em>Human Compatible: Artificial Intelligence and the Problem of Control</em>. Viking. <a href="https://www.amazon.com/Human-Compatible-Artificial-Intelligence-Control/dp/0525558616">https://www.amazon.com/Human-Compatible-Artificial-Intelligence-Control/dp/0525558616</a>.
</div>
<div id="ref-Russell2020" class="csl-entry" role="listitem">
Russell, Stuart, and Peter Norvig. 2020. <em>Artificial Intelligence: A Modern Approach</em>. 4th ed. Pearson. <a href="https://www.amazon.com/Artificial-Intelligence-Modern-Approach-4th/dp/0134610997">https://www.amazon.com/Artificial-Intelligence-Modern-Approach-4th/dp/0134610997</a>.
</div>
<div id="ref-Trajtenberg2018" class="csl-entry" role="listitem">
Trajtenberg, Moses. 2018. <span>“AI as the Next GPT: A Political-Economy Perspective.”</span> 24245. NBER. <a href="https://www.nber.org/system/files/working_papers/w24245/w24245.pdf">https://www.nber.org/system/files/working_papers/w24245/w24245.pdf</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Adaptive capital, in the context of AI economics, refers to a form of productive asset exhibiting dynamic learning capabilities, autonomous decision-making, and task flexibility. Key characteristics include: (1) dynamic efficiency through self-improvement, (2) repurposability for diverse tasks, (3) autonomous complex decision-making, (4) low marginal costs allowing rapid scaling, and (5) potential complementarity with high-skill labor. Economic implications involve shifts in capital-labor returns, firm boundaries, growth models, and productivity measures. This concept synthesizes insights from endogenous growth theory, AI economics, labor economics, and industrial organization <span class="citation" data-cites="Brynjolfsson2017 Agrawal2018 Acemoglu2018 Trajtenberg2018">(<a href="#ref-Brynjolfsson2017" role="doc-biblioref">Brynjolfsson and McAfee 2017</a>; <a href="#ref-Agrawal2018" role="doc-biblioref">Agrawal, Gans, and Goldfarb 2018</a>; <a href="#ref-Acemoglu2018" role="doc-biblioref">Acemoglu and Restrepo 2018</a>; <a href="#ref-Trajtenberg2018" role="doc-biblioref">Trajtenberg 2018</a>)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>